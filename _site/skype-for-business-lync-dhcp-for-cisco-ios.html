<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>tristangriffiths.net | tristangriffiths.net</title>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<meta name="author" content="">
<link href="/rss" rel="alternate" type="application/rss+xml" title="tristangriffiths.net" />
<meta property="og:type" content="">
<meta property="og:locale" content="en_AU">
<meta property="og:site_name" content="tristangriffiths.net">
<meta property="og:title" content="Skype for Business (Lync) device DHCP for Cisco IOS">
<meta property="og:url" content="">

  <meta property="og:description" content="">



  <meta property="article:published_time" content="2015-07-18T00:00:00+10:00">


<link rel="canonical" href="">


<!-- Bootstrap CSS -->
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
<!-- Font Awesome CSS -->
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<!-- Purdy Fonts CSS -->
<link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
<!-- Site -->
<link href="/assets/css/site.min.css" rel="stylesheet" type="text/css">
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
	<!-- Navigation -->
	<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
		<div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">tristangriffiths.net</a>
    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav navbar-right">
            <li>
                <a href="/">Home</a>
            </li>
            <li>
                <a href="/about">About</a>
            </li>
        </ul>
    </div>
    <!-- /.navbar-collapse -->
</div>
<!-- /.container -->
	</nav>
	
	<!-- Page Header -->
<header class="intro-header" style="background-image: url('/assets/img/powershell.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1 id="title">Skype for Business (Lync) device DHCP for Cisco IOS</h1>
                    <h2 class="subheading">Some PowerShell scripting</h2>
                    <span class="meta">Posted on July 18, 2015</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article itemscope itemtype="http://schema.org/BlogPosting">
    <meta itemprop="name" content="Skype for Business (Lync) device DHCP for Cisco IOS" />
    <meta itemprop="headline" content="Some PowerShell scripting" />
    <meta itemprop="datepublished" content="July 18, 2015">
    
    <meta itemprop="image" content="/assets/img/powershell.jpg" />	
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1" itemprop="articleBody">
                <h3 id="introduction">Introduction</h3>

<p>While designing a Skype for Business deployment for a customer, a requirement was discovered that meant we would need to provide a DHCP configuration to their WAN vendor. Each of the sites would be using Polycom VVX devices with IP addresses obtained from a Cisco router.</p>

<p><a href="https://neillpert.wordpress.com/2011/11/30/configuring-a-cisco-isr861s-dhcp-service-for-lync-edition-handsets/" title="Configuring a Cisco ISR861’s DHCP Service for Lync Edition Handset">Neill Pert describes the process</a> of taking output from DHCPUtil and massaging to a usable format but wouldn’t it be nice if we didn’t have to mess around with concatenating strings and counting lengths?</p>

<p>Introducing my first non-commercial contribution to the internets: Get-CsCiscoIosDhcp.ps1</p>

<h3 id="creating-the-configuration">Creating the Configuration</h3>

<p>Fire up PowerShell and run the script:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>.\Get-CsCiscoIosDhcp.ps1
</code></pre></div></div>

<p>The script will then ask for DHCP options needed for a successful Lync Phone Edition/Qualified deployment with PIN authentication:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DNS suffix (eg. contoso.local): contoso.local
UTC/GMT Offset Hours (eg. +/-10): 10
NTP server address (eg. 192.168.0.1): 192.168.0.254
NTP server address (eg. 192.168.0.1): 
DNS search domain (eg. contoso.local): contoso.local
DNS search domain (eg. contoso.local): contoso.com
DNS search domain (eg. contoso.local):
SfB/Lync SIP FQDN (eg. sip.contoso.com): sip.contoso.com
SfB/Lync Web FQDN (eg. lyncwebint.contoso.com): sip.contoso.com
</code></pre></div></div>

<p>Done:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-------------------------------------------------------
Cisco IOS DHCP configuration for the following values :
-------------------------------------------------------
DNS suffix : contoso.local
Time Offset : 10
NTP Servers : 192.168.0.254
DNS Search List : contoso.local contoso.com
SIP Server : sip.contoso.com
Web Server : sip.contoso.com
-------------------------------------------------------
domain-name "contoso.local"
option 2 hex 00008ca0
option 42 ip 192.168.0.254
option 119 hex 07636f6e746f736f056c6f63616c0007636f6e746f736f03636f6d00
option 120 hex 000373697007636f6e746f736f03636f6d00
option 43 hex 010c4d532d55432d436c69656e7402056874747073030f7369702e636f6e746f736f2e636f6d040334343305252f4365727450726f762f4365727450726f766973696f6e696e67536572766963652e737663
-------------------------------------------------------
</code></pre></div></div>
<h3 id="revision-history">Revision History</h3>

<p>v0.1: 19 July 2015: Initial release</p>

<h3 id="download">Download</h3>

<p><a href="/assets/misc/get-csciscoiosdhcp.zip" title="Download">Download Get-CsCiscoIosDhcp.ps1</a></p>

<h3 id="credits">Credits</h3>

<p>Configuring a Cisco ISR861’s DHCP Service for Lync Edition Handset - <a href="https://neillpert.wordpress.com/2011/11/30/configuring-a-cisco-isr861s-dhcp-service-for-lync-edition-handsets/" title="Configuring a Cisco ISR861’s DHCP Service for Lync Edition Handset">https://neillpert.wordpress.com/2011/11/30/configuring-a-cisco-isr861s-dhcp-service-for-lync-edition-handsets/</a></p>

<p>Cisco support community post by Michael Solomonides describing option 119 - <a href="https://supportforums.cisco.com/discussion/11213696/dhcp-pool-dns-search-list-option-119">https://supportforums.cisco.com/discussion/11213696/dhcp-pool-dns-search-list-option-119</a></p>

<p>Setting Up DHCP for Devices - <a href="https://technet.microsoft.com/en-us/library/gg398369(v=ocs.14).aspx" title="Setting Up DHCP for Devices">https://technet.microsoft.com/en-us/library/gg398369(v=ocs.14).aspx</a></p>

            </div>
        </div>
    </div>
</article>

	<!-- Footer -->
	<footer>
		<div class="container">
	<div class="row">
		<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
			<ul class="list-inline text-center">
				<li>
					<a href="https://au.linkedin.com/in/trgriffiths">
						<span class="fa-stack fa-lg">
							<i class="fa fa-circle fa-stack-2x"></i>
							<i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
						</span>
					</a>
				</li>
				<li>
					<a href="/rss">
						<span class="fa-stack fa-lg">
							<i class="fa fa-circle fa-stack-2x"></i>
							<i class="fa fa-rss fa-stack-1x fa-inverse"></i>
						</span>
					</a>
				</li>
			</ul>
			<p class="copyright text-muted">Tristan Griffiths &copy; Copyright 2019. All Rights Reserved.</p>
		</div>
	</div>
</div>
	</footer>
	
	<!-- jQuery JS -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap JS -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<!-- Site -->
<script src="/assets/js/site.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-65313416-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
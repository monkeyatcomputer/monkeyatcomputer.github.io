<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>tristangriffiths.net | tristangriffiths.net</title>
<meta name="description" content=""/>
<meta name="keywords" content=""/>
<meta name="author" content="">
<link href="/rss" rel="alternate" type="application/rss+xml" title="tristangriffiths.net" />
<meta property="og:type" content="">
<meta property="og:locale" content="en_AU">
<meta property="og:site_name" content="tristangriffiths.net">
<meta property="og:title" content="Skype for Business (Lync) Web Services Warmup">
<meta property="og:url" content="">

  <meta property="og:description" content="">



  <meta property="article:published_time" content="2015-09-13T00:00:00+10:00">


<link rel="canonical" href="">


<!-- Bootstrap CSS -->
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
<!-- Font Awesome CSS -->
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<!-- Purdy Fonts CSS -->
<link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
<!-- Site -->
<link href="/assets/css/site.min.css" rel="stylesheet" type="text/css">
<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
  <script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
	<!-- Navigation -->
	<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
		<div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">tristangriffiths.net</a>
    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav navbar-right">
            <li>
                <a href="/">Home</a>
            </li>
            <li>
                <a href="/about">About</a>
            </li>
        </ul>
    </div>
    <!-- /.navbar-collapse -->
</div>
<!-- /.container -->
	</nav>
	
	<!-- Page Header -->
<header class="intro-header" style="background-image: url('/assets/img/iispreload.png')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1 id="title">Skype for Business (Lync) Web Services Warmup</h1>
                    <h2 class="subheading">Application Initialisation is my new favourite Windows technology</h2>
                    <span class="meta">Posted on September 13, 2015</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article itemscope itemtype="http://schema.org/BlogPosting">
    <meta itemprop="name" content="Skype for Business (Lync) Web Services Warmup" />
    <meta itemprop="headline" content="Application Initialisation is my new favourite Windows technology" />
    <meta itemprop="datepublished" content="September 13, 2015">
    
    <meta itemprop="image" content="/assets/img/iispreload.png" />	
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1" itemprop="articleBody">
                <h3 id="problem">Problem</h3>

<p>This blog runs on Umbraco and due its popularity, or lack thereof, IIS was shutting down the application pool frequently. Not the best first impression if a visitor has to wait 10 seconds for the application to start before they’ve even received a single byte of HTML. The same issue applies to Skype for Business (Lync) and all of its web services (meet, dialin, lyncdiscover, scheduler, ucwa, …).</p>

<h3 id="solution">Solution</h3>

<p>While writing a script that would call the website to be executed from a scheduled task, I happened across a technology called IIS Application Initialization. As explained by the documentation, “<span>The IIS 8.0 Application Initialization feature enables website administrators to configure IIS 8.0 to proactively perform initialization tasks for one or more web applications</span>”.</p>

<p>No need to document the steps required, it’s all here: <a href="http://www.iis.net/learn/get-started/whats-new-in-iis-8/iis-80-application-initialization" title="IIS 8.0 Application Initialization">http://www.iis.net/learn/get-started/whats-new-in-iis-8/iis-80-application-initialization</a></p>

<p>Now when I visit this blog, even after an iisreset, it’s always warm and ready to go.</p>

<p><span>Next I turned my attention to Skype for Business and there are two warm up solutions that I have used, the original by <a href="http://www.lynclog.com/2013/12/user-might-experince-delay-when-join.html" title="User might experince delay when join Lync Online Meeting">Drago Totev</a> and the improved version by <a href="https://greiginsydney.com/new-lyncmeetingwarmup/" title="New-LyncMeetingWarmup">Greig Sheridan</a> however they both focus on just the meeting join URLs. </span></p>

<h3 id="script">Script</h3>

<p>The Powershell script will configure each of the Skype for Business or Lync application pools to be “Always running”. It will then iterate through each of the applications / virtual directories and set preload enabled. The script does not enable preload for CSCP, PowerShell remoting and legacy services like MCX. Tested on Windows Server 2012 and 2012 R2 with both Lync Server 2013 and Skype for Business Server 2015.</p>

<p>It’s up to you to install the Application Initialization Windows feature as detailed in the <a href="http://www.iis.net/learn/get-started/whats-new-in-iis-8/iis-80-application-initialization" title="IIS 8.0 Application Initialization">IIS documentation</a> and do an iisreset.</p>

<p>Whether you <em>should</em> enable Application Initialization on your Skype for Business or Lync front-end servers… Well… Caveat emptor. IIS will use more memory but so long as you have more than 2.5GB free afterwards, then you should be fine.</p>

<p>If this sounds too risky for you, perhaps stick with <a href="https://greiginsydney.com/new-lyncmeetingwarmup/" title="New-LyncMeetingWarmup">Greig Sheridan’s</a> solution.</p>

<h3 id="revision-history">Revision History</h3>

<p>v1.0: 13 Sep 2015: Initial Release</p>

<h3 id="download">Download</h3>

<p>Download <a href="/assets/misc/set-csapplicationinitialization.zip" title="Set-CsApplicationInitialization.zip">Set-CsApplicationInitialization.ps1</a>.</p>

<h3 id="credits">Credits</h3>

<p>New-LyncMeetingWarmup - <a href="https://greiginsydney.com/new-lyncmeetingwarmup/" title="New-LyncMeetingWarmup">https://greiginsydney.com/new-lyncmeetingwarmup/</a></p>

<p>User might experince delay when join Lync Online Meeting - <a href="http://www.lynclog.com/2013/12/user-might-experince-delay-when-join.html" title="User might experince delay when join Lync Online Meeting">http://www.lynclog.com/2013/12/user-might-experince-delay-when-join.html</a></p>

            </div>
        </div>
    </div>
</article>

	<!-- Footer -->
	<footer>
		<div class="container">
	<div class="row">
		<div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
			<ul class="list-inline text-center">
				<li>
					<a href="https://au.linkedin.com/in/trgriffiths">
						<span class="fa-stack fa-lg">
							<i class="fa fa-circle fa-stack-2x"></i>
							<i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
						</span>
					</a>
				</li>
				<li>
					<a href="/rss">
						<span class="fa-stack fa-lg">
							<i class="fa fa-circle fa-stack-2x"></i>
							<i class="fa fa-rss fa-stack-1x fa-inverse"></i>
						</span>
					</a>
				</li>
			</ul>
			<p class="copyright text-muted">Tristan Griffiths &copy; Copyright 2019. All Rights Reserved.</p>
		</div>
	</div>
</div>
	</footer>
	
	<!-- jQuery JS -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap JS -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

<!-- Site -->
<script src="/assets/js/site.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-65313416-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>